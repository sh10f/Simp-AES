# S-AES 接口文档

## 1. 类和方法

### 1.1 `S_AES` 类
`S_AES` 类是该程序的核心类，负责控制 S-AES 加密、解密以及多层加密的流程。

#### `control(input, key, mode="en", isForward=True, keyOrder=None, strategy=None)`
执行加密、解密或多重加密操作。

- **参数**：
  - `input`：待加密或解密的二进制数组，数据格式为 `(n,)`。
  - `key`：用于加密或解密的密钥，数据格式为 `(16,)`。
  - `mode`：操作模式，默认值为 `"en"`，支持 `"en"`（加密）、`"de"`（解密）、`"multi"`（多重加密）。
  - `isForward`：布尔值，是否按加密顺序操作，默认为 `True`。在 `"multi"` 模式中，该参数决定是否执行加密还是解密。
  - `keyOrder`：密钥顺序的数组（仅用于多重加密），用于定义每层加密的密钥顺序。
  - `strategy`：加解密策略数组（仅用于多重加密），`0` 表示加密，`1` 表示解密。
  
- **返回值**：加密或解密后的二进制数组。

#### `encrypt(input, key)`
执行单轮的加密操作。

- **参数**：
  - `input`：待加密的二进制数组，格式为 `(n,)`。
  - `key`：用于加密的密钥，格式为 `(16,)`。
  
- **返回值**：加密后的二进制数组，格式为 `(16,)`。

#### `decrypt(input, key)`
执行单轮的解密操作。

- **参数**：
  - `input`：待解密的二进制数组，格式为 `(n,)`。
  - `key`：用于解密的密钥，格式为 `(16,)`。
  
- **返回值**：解密后的二进制数组，格式为 `(16,)`。

#### `multi(input, key, keyOrder, strategy, isForward=True)`
支持自定义层数的多重加密或解密。

- **参数**：
  - `input`：待加密或解密的二进制数组，格式为 `(n,)`。
  - `key`：包含多层加密所需的密钥，格式为 `(n, 16)`。
  - `keyOrder`：密钥顺序数组，定义每层加密使用的密钥顺序。
  - `strategy`：加解密策略数组，定义每层的加解密操作（`0` 表示加密，`1` 表示解密）。
  - `isForward`：布尔值，是否按照加密顺序执行多重加密。

- **返回值**：多重加密或解密后的二进制数组。

#### `cbc(inputs, IV, key, isForward=True)`
实现CBC（密码分组链接）模式的加密和解密。

- **参数**：
  - `inputs`：待加密或解密的二进制数组，格式为 `(n,)`，应是16位的整数倍。
  - `IV`：初始向量，格式为 `(16,)` 的二进制数组。
  - `key`：用于加解密的密钥，格式为 `(16,)`。
  - `isForward`：布尔值，`True` 表示加密，`False` 表示解密。
  
- **返回值**：加密或解密后的二进制数组。

#### `mimAttach(plain, cipher)`
使用中间相遇攻击尝试破解双重加密的密钥。

- **参数**：
  - `plain`：明文二进制数组。
  - `cipher`：密文二进制数组。
  
- **返回值**：找到的密钥对（如果成功），格式为 `(32,)` 的二进制数组。

#### `dataTrans(input)`
将输入的数据转换为内部所需的格式。

- **参数**：
  - `input`：待转换的数据，格式为 `(n,)` 的一维数组。
  
- **返回值**：转换后的数据，格式为 `(8, 2)` 的二进制矩阵。

#### `dataOut(input)`
将内部数据格式转换为外部输出格式。

- **参数**：
  - `input`：内部数据格式，格式为 `(8, 2)` 的二进制矩阵。
  
- **返回值**：输出数据，格式为 `(n,)` 的一维数组。

### 1.2 `SBox` 类
`SBox` 类负责字节替换操作，通过S盒进行字节的前向和逆向替换。

#### `forward(input)`
执行字节的前向替换，用于加密。

- **参数**：
  - `input`：4位的二进制数组，格式为 `(4,)`。
  
- **返回值**：替换后的二进制数组，格式为 `(4,)`。

#### `reverse(input)`
执行字节的逆向替换，用于解密。

- **参数**：
  - `input`：4位的二进制数组，格式为 `(4,)`。
  
- **返回值**：替换后的二进制数组，格式为 `(4,)`。

### 1.3 `keyGenerator` 类
`keyGenerator` 类用于生成多轮密钥。

#### `__init__(self, key, num_keys)`
构造函数，初始化密钥生成器。

- **参数**：
  - `key`：用于扩展的密钥，格式为 `(16,)`。
  - `num_keys`：需要生成的密钥数量。

#### `expandKey(isForward=True)`
生成多轮密钥。

- **参数**：
  - `isForward`：布尔值，`True` 生成加密时使用的密钥，`False` 生成解密时使用的密钥。
  
- **返回值**：生成的密钥，格式为 `(n, 8)` 的二进制矩阵，包含3轮密钥。

## 2. 实用函数

实用函数在 `utils.py` 文件中定义，负责二进制、十进制以及字符串之间的转换操作。

### 2.1 `binToDec(input)`
将二进制数组转换为十进制数。

- **参数**：
  - `input`：二进制数组。
  
- **返回值**：对应的十进制数。

### 2.2 `decToBin(input, isInt8=True)`
将十进制数转换为二进制数组。

- **参数**：
  - `input`：十进制数。
  - `isInt8`：布尔值，`True` 表示返回8位二进制数组，`False` 表示返回16位。
  
- **返回值**：对应的二进制数组。

### 2.3 `strToBytes(strings, isBinary=True)`
将字符串转换为字节数组。

- **参数**：
  - `strings`：待转换的字符串。
  - `isBinary`：布尔值，`True` 表示将字符串视为二进制字符串，`False` 表示将字符串转换为UTF-8格式的字节数组。
  
- **返回值**：二进制数组或字节数组。

### 2.4 `bytesToStr(binary_array, isBinary=True)`
将字节数组转换为字符串。

- **参数**：
  - `binary_array`：待转换的二进制数组。
  - `isBinary`：布尔值，`True` 表示将字节数组视为二进制字符串，`False` 表示将其转换为UTF-8格式的字符串。
  
- **返回值**：转换后的字符串。

### 2.5 `hexToBytes(hex_string)`
将十六进制字符串转换为字节数组。

- **参数**：
  - `hex_string`：待转换的十六进制字符串。
  
- **返回值**：对应的字节数组。

### 2.6 `bytesToHex(byte_array)`
将字节数组转换为十六进制字符串。

- **参数**：
  - `byte_array`：待转换的字节数组。
  
- **返回值**：对应的十六进制字符串。
